(self.webpackChunk_datadog_browser_rum=self.webpackChunk_datadog_browser_rum||[]).push([["recorder"],{751(t,e,n){n.r(e),n.d(e,{startRecording:()=>ct});var o=n(534),s=n(725),r=n(362),i=n(769),a=n(300),c=n(474),u=n(197),l=n(877),d=n(93);const p=new WeakMap;function f(t){return p.has(t)}function h(t){return p.get(t)}function m(t,e){const n=t.tagName,o=t.value;if((0,d.Ie)(t,e)){const e=t.type;if("INPUT"===n&&("button"===e||"submit"===e||"reset"===e))return o;if(!o||"OPTION"===n)return;return d.o}return"OPTION"===n||"SELECT"===n?t.value:"INPUT"===n||"TEXTAREA"===n?o:void 0}const g=/url\((?:(')([^']*)'|(")([^"]*)"|([^)]*))\)/gm,y=/^[A-Za-z]+:|^\/\//,v=/^["']?data:.*,/i,w=/[^a-z1-6-_]/;function x(t){const e=t.toLowerCase().trim();return w.test(e)?"div":e}function S(t,e){return`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${t}' height='${e}' style='background-color:silver'%3E%3C/svg%3E`}function T(t){if(void 0!==t&&0!==t.length)return t.map(t=>{const e=t.cssRules||t.rules;return{cssRules:Array.from(e,t=>t.cssText),disabled:t.disabled||void 0,media:t.media.length>0?Array.from(t.media):void 0}})}var b=n(760);function N(t,e,n,o){if(e===d.$m.HIDDEN)return null;const s=t.getAttribute(n);if(e===d.$m.MASK&&n!==d.NT&&!d.yF.includes(n)&&n!==o.actionNameAttribute){const e=t.tagName;switch(n){case"title":case"alt":case"placeholder":return d.o}if("IMG"===e&&("src"===n||"srcset"===n)){const e=t;if(e.naturalWidth>0)return S(e.naturalWidth,e.naturalHeight);const{width:n,height:o}=t.getBoundingClientRect();return n>0||o>0?S(n,o):d.eT}if("SOURCE"===e&&("src"===n||"srcset"===n))return d.eT;if("A"===e&&"href"===n)return d.o;if(s&&n.startsWith("data-"))return d.o;if("IFRAME"===e&&"srcdoc"===n)return d.o}return s&&"string"==typeof s?(0,d.ei)(s,1e6):s}function E(t,e){t.cssText.count+=1,t.cssText.max=Math.max(t.cssText.max,e),t.cssText.sum+=e}function C(t){if(!t)return null;let e;try{e=t.rules||t.cssRules}catch(t){}return e?(n=Array.from(e,(0,b.nr)()?I:R).join(""),o=t.href,n.replace(g,(t,e,n,s,r,i)=>{const a=n||r||i;if(!o||!a||y.test(a)||v.test(a))return t;const c=e||s||"";return`url(${c}${function(t,e){try{return(0,l.c$)(t,e).href}catch(e){return t}}(a,o)}${c})`})):null;var n,o}function I(t){if(function(t){return"selectorText"in t}(t)&&t.selectorText.includes(":")){const e=/(\[[\w-]+[^\\])(:[^\]]+\])/g;return t.cssText.replace(e,"$1\\$2")}return R(t)}function R(t){return function(t){return"styleSheet"in t}(t)&&C(t.styleSheet)||t.cssText}function _(t,e){const n=function(t,e){switch(t.nodeType){case t.DOCUMENT_NODE:return function(t,e){return{type:0,childNodes:O(t,e),adoptedStyleSheets:T(t.adoptedStyleSheets)}}(t,e);case t.DOCUMENT_FRAGMENT_NODE:return function(t,e){const n=(0,d.p_)(t);return n&&e.serializationContext.shadowRootsController.addShadowRoot(t),{type:11,childNodes:O(t,e),isShadowRoot:n,adoptedStyleSheets:n?T(t.adoptedStyleSheets):void 0}}(t,e);case t.DOCUMENT_TYPE_NODE:return{type:1,name:(n=t).name,publicId:n.publicId,systemId:n.systemId};case t.ELEMENT_NODE:return function(t,e){const n=x(t.tagName),o="svg"===(r=t).tagName||r instanceof SVGElement||void 0,s=(0,d.jR)((0,d.dT)(t),e.parentNodePrivacyLevel);var r;if(s===d.$m.HIDDEN){const{width:e,height:s}=t.getBoundingClientRect();return{type:2,tagName:n,attributes:{rr_width:e+"px",rr_height:s+"px",[d.NT]:d.Wd},childNodes:[],isSVG:o}}if(s===d.$m.IGNORE)return;const i=function(t,e,n){if(e===d.$m.HIDDEN)return{};const o={},s=x(t.tagName),r=t.ownerDocument;for(let s=0;s<t.attributes.length;s+=1){const r=t.attributes.item(s).name,i=N(t,e,r,n.configuration);null!==i&&(o[r]=i)}if(t.value&&("textarea"===s||"select"===s||"option"===s||"input"===s)){const n=m(t,e);void 0!==n&&(o.value=n)}if("option"===s&&e===d.$m.ALLOW){const e=t;e.selected&&(o.selected=e.selected)}if("link"===s){const e=Array.from(r.styleSheets).find(e=>e.href===t.href),s=C(e);s&&e&&(E(n.serializationContext.serializationStats,s.length),o._cssText=s)}if("style"===s&&t.sheet){const e=C(t.sheet);e&&(E(n.serializationContext.serializationStats,e.length),o._cssText=e)}const i=t;if("input"!==s||"radio"!==i.type&&"checkbox"!==i.type||(e===d.$m.ALLOW?o.checked=!!i.checked:(0,d.Ie)(i,e)&&delete o.checked),"audio"===s||"video"===s){const e=t;o.rr_mediaState=e.paused?"paused":"played"}let a,c;const u=n.serializationContext;switch(u.status){case 0:a=Math.round(t.scrollTop),c=Math.round(t.scrollLeft),(a||c)&&u.elementsScrollPositions.set(t,{scrollTop:a,scrollLeft:c});break;case 1:u.elementsScrollPositions.has(t)&&({scrollTop:a,scrollLeft:c}=u.elementsScrollPositions.get(t))}return c&&(o.rr_scrollLeft=c),a&&(o.rr_scrollTop=a),o}(t,s,e);let a=[];if((0,d.wR)(t)&&"style"!==n){let o;o=e.parentNodePrivacyLevel===s&&e.ignoreWhiteSpace===("head"===n)?e:{...e,parentNodePrivacyLevel:s,ignoreWhiteSpace:"head"===n},a=O(t,o)}return{type:2,tagName:n,attributes:i,childNodes:a,isSVG:o}}(t,e);case t.TEXT_NODE:return function(t,e){const n=(0,d.rf)(t,e.ignoreWhiteSpace||!1,e.parentNodePrivacyLevel);if(void 0!==n)return{type:3,textContent:n}}(t,e);case t.CDATA_SECTION_NODE:return{type:4,textContent:""}}var n}(t,e);if(!n)return null;const o=h(t)||L++,s=n;return s.id=o,function(t,e){p.set(t,e)}(t,o),e.serializedNodeIds&&e.serializedNodeIds.add(o),s}let L=1;function O(t,e){const n=[];return(0,d.wI)(t,t=>{const o=_(t,e);o&&n.push(o)}),n}function M(t,e,n){return _(t,{serializationContext:n,parentNodePrivacyLevel:e.defaultPrivacyLevel,configuration:e})}function D(t){return!!t.changedTouches}function P(t){return!0===t.composed&&(0,d.XS)(t.target)?t.composedPath()[0]:t.target}const $=t=>({scale:t.scale,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,pageLeft:t.pageLeft,pageTop:t.pageTop,height:t.height,width:t.width});var k=n(749);function A(t,e){return{data:{source:t,...e},type:3,timestamp:(0,k.nx)()}}function z(t,e){const{throttled:n,cancel:o}=(0,c.n)(t=>{const n=P(t);if(f(n)){const o=H(t);if(!o)return;const s={id:h(n),timeOffset:0,x:o.x,y:o.y};e(A(D(t)?6:1,{positions:[s]}))}},50,{trailing:!1}),{stop:s}=(0,u.l)(t,document,["mousemove","touchmove"],n,{capture:!0,passive:!0});return{stop(){s(),o()}}}function H(t){let{clientX:e,clientY:n}=D(t)?t.changedTouches[0]:t;if(window.visualViewport){const{visualViewportX:t,visualViewportY:o}=((t,e)=>{const n=window.visualViewport,o={layoutViewportX:t,layoutViewportY:e,visualViewportX:t,visualViewportY:e};return n?(function(t){return Math.abs(t.pageTop-t.offsetTop-window.scrollY)>25||Math.abs(t.pageLeft-t.offsetLeft-window.scrollX)>25}(n)?(o.layoutViewportX=Math.round(t+n.offsetLeft),o.layoutViewportY=Math.round(e+n.offsetTop)):(o.visualViewportX=Math.round(t-n.offsetLeft),o.visualViewportY=Math.round(e-n.offsetTop)),o):o})(e,n);e=t,n=o}if(Number.isFinite(e)&&Number.isFinite(n))return{x:e,y:n};t.isTrusted&&(0,o.A2)("mouse/touch event without x/y")}const V={pointerup:0,mousedown:1,click:2,contextmenu:3,dblclick:4,focus:5,blur:6,touchstart:7,touchend:9};function F(t,e,n){return(0,u.l)(t,document,Object.keys(V),o=>{const s=P(o);if((0,d.PJ)(s,t.defaultPrivacyLevel)===d.$m.HIDDEN||!f(s))return;const r=h(s),i=V[o.type];let a;if(6!==i&&5!==i){const t=H(o);if(!t)return;a={id:r,type:i,x:t.x,y:t.y}}else a={id:r,type:i};const c={id:n.getIdForEvent(o),...A(2,a)};e(c)},{capture:!0,passive:!0})}function G(t,e,n,o=document){const{throttled:s,cancel:r}=(0,c.n)(o=>{const s=P(o);if(!s||(0,d.PJ)(s,t.defaultPrivacyLevel)===d.$m.HIDDEN||!f(s))return;const r=h(s),i=s===document?{scrollTop:(0,d.zL)(),scrollLeft:(0,d.Gn)()}:{scrollTop:Math.round(s.scrollTop),scrollLeft:Math.round(s.scrollLeft)};n.set(s,i),e(A(3,{id:r,x:i.scrollLeft,y:i.scrollTop}))},100),{stop:i}=(0,u.q)(t,o,"scroll",s,{capture:!0,passive:!0});return{stop(){i(),r()}}}function W(t,e){const n=(0,d.g1)(t).subscribe(t=>{e(A(4,t))});return{stop(){n.unsubscribe()}}}function B(t,e){const n=window.visualViewport;if(!n)return{stop:c.l};const{throttled:o,cancel:s}=(0,c.n)(()=>{e({data:$(n),type:8,timestamp:(0,k.nx)()})},200,{trailing:!1}),{stop:r}=(0,u.l)(t,n,["resize","scroll"],o,{capture:!0,passive:!0});return{stop(){r(),s()}}}function J(t,e){return(0,u.l)(t,document,["play","pause"],n=>{const o=P(n);o&&(0,d.PJ)(o,t.defaultPrivacyLevel)!==d.$m.HIDDEN&&f(o)&&e(A(7,{id:h(o),type:"play"===n.type?0:1}))},{capture:!0,passive:!0})}var X=n(801);function Y(t){function e(t,e){t&&f(t.ownerNode)&&e(h(t.ownerNode))}const n=[(0,X.H)(CSSStyleSheet.prototype,"insertRule",({target:n,parameters:[o,s]})=>{e(n,e=>t(A(8,{id:e,adds:[{rule:o,index:s}]})))}),(0,X.H)(CSSStyleSheet.prototype,"deleteRule",({target:n,parameters:[o]})=>{e(n,e=>t(A(8,{id:e,removes:[{index:o}]})))})];function o(o){n.push((0,X.H)(o.prototype,"insertRule",({target:n,parameters:[o,s]})=>{e(n.parentStyleSheet,e=>{const r=U(n);r&&(r.push(s||0),t(A(8,{id:e,adds:[{rule:o,index:r}]})))})}),(0,X.H)(o.prototype,"deleteRule",({target:n,parameters:[o]})=>{e(n.parentStyleSheet,e=>{const s=U(n);s&&(s.push(o),t(A(8,{id:e,removes:[{index:s}]})))})}))}return"undefined"!=typeof CSSGroupingRule?o(CSSGroupingRule):(o(CSSMediaRule),o(CSSSupportsRule)),{stop(){n.forEach(t=>t.stop())}}}function U(t){const e=[];let n=t;for(;n.parentRule;){const t=Array.from(n.parentRule.cssRules).indexOf(n);e.unshift(t),n=n.parentRule}if(!n.parentStyleSheet)return;const o=Array.from(n.parentStyleSheet.cssRules).indexOf(n);return e.unshift(o),e}function q(t,e){return(0,u.l)(t,window,["focus","blur"],()=>{e({data:{has_focus:document.hasFocus()},type:6,timestamp:(0,k.nx)()})})}function j(t,e,n){const o=t.subscribe(12,t=>{var o,s;t.rawRumEvent.type===d.bb.ACTION&&t.rawRumEvent.action.type===d.X2.CLICK&&(null===(s=null===(o=t.rawRumEvent.action.frustration)||void 0===o?void 0:o.type)||void 0===s?void 0:s.length)&&"events"in t.domainContext&&t.domainContext.events&&t.domainContext.events.length&&e({timestamp:t.rawRumEvent.date,type:9,data:{frustrationTypes:t.rawRumEvent.action.frustration.type,recordIds:t.domainContext.events.map(t=>n.getIdForEvent(t))}})});return{stop(){o.unsubscribe()}}}function K(t,e){const n=t.subscribe(5,()=>{e({timestamp:(0,k.nx)(),type:7})});return{stop(){n.unsubscribe()}}}function Z(t,e,n=document){const o=t.defaultPrivacyLevel,s=new WeakMap,r=n!==document,{stop:i}=(0,u.l)(t,n,r?["change"]:["input","change"],t=>{const e=P(t);(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement)&&l(e)},{capture:!0,passive:!0});let a;if(r)a=c.l;else{const t=[(0,X.t)(HTMLInputElement.prototype,"value",l),(0,X.t)(HTMLInputElement.prototype,"checked",l),(0,X.t)(HTMLSelectElement.prototype,"value",l),(0,X.t)(HTMLTextAreaElement.prototype,"value",l),(0,X.t)(HTMLSelectElement.prototype,"selectedIndex",l)];a=()=>{t.forEach(t=>t.stop())}}return{stop(){a(),i()}};function l(t){const e=(0,d.PJ)(t,o);if(e===d.$m.HIDDEN)return;const n=t.type;let s;if("radio"===n||"checkbox"===n){if((0,d.Ie)(t,e))return;s={isChecked:t.checked}}else{const n=m(t,e);if(void 0===n)return;s={text:n}}p(t,s);const r=t.name;"radio"===n&&r&&t.checked&&document.querySelectorAll(`input[type="radio"][name="${CSS.escape(r)}"]`).forEach(e=>{e!==t&&p(e,{isChecked:!1})})}function p(t,n){if(!f(t))return;const o=s.get(t);o&&o.text===n.text&&o.isChecked===n.isChecked||(s.set(t,n),e(A(5,{id:h(t),...n})))}}var Q=n(315),tt=n(981);function et(t,e,n,o){const s=(0,d.W3)();if(!s)return{stop:c.l,flush:c.l};const r=function(){let o=c.l,s=[];function r(){o(),function(t,e,n,o){const s=new Map;t.filter(t=>"childList"===t.type).forEach(t=>{t.removedNodes.forEach(t=>{nt(t,o.removeShadowRoot)})});const r=t.filter(t=>t.target.isConnected&&function(t){let e=t;for(;e;){if(!f(e)&&!(0,d.p_)(e))return!1;e=(0,d.$4)(e)}return!0}(t.target)&&(0,d.PJ)(t.target,n.defaultPrivacyLevel,s)!==d.$m.HIDDEN),i={cssText:{count:0,max:0,sum:0}},{adds:a,removes:c,hasBeenSerialized:u}=function(t,e,n,o,s){const r=new Set,i=new Map;for(const e of t)e.addedNodes.forEach(t=>{r.add(t)}),e.removedNodes.forEach(t=>{r.has(t)||i.set(t,e.target),r.delete(t)});const a=Array.from(r);a.sort((t,e)=>{const n=t.compareDocumentPosition(e);return n&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:n&Node.DOCUMENT_POSITION_CONTAINS||n&Node.DOCUMENT_POSITION_FOLLOWING?1:n&Node.DOCUMENT_POSITION_PRECEDING?-1:0});const c=new Set,u={status:2,serializationStats:n,shadowRootsController:o},l=[];for(const t of a){if(m(t))continue;const n=(0,d.PJ)(t.parentNode,e.defaultPrivacyLevel,s);if(n===d.$m.HIDDEN||n===d.$m.IGNORE)continue;const o=_(t,{serializedNodeIds:c,parentNodePrivacyLevel:n,serializationContext:u,configuration:e});if(!o)continue;const r=(0,d.$4)(t);l.push({nextId:g(t),parentId:h(r),node:o})}const p=[];return i.forEach((t,e)=>{f(e)&&p.push({parentId:h(t),id:h(e)})}),{adds:l,removes:p,hasBeenSerialized:m};function m(t){return f(t)&&c.has(h(t))}function g(t){let e=t.nextSibling;for(;e;){if(f(e))return h(e);e=e.nextSibling}return null}}(r.filter(t=>"childList"===t.type),n,i,o,s),l=function(t,e,n){var o;const s=[],r=new Set,i=t.filter(t=>!r.has(t.target)&&(r.add(t.target),!0));for(const t of i){if(t.target.textContent===t.oldValue)continue;const r=(0,d.PJ)((0,d.$4)(t.target),e.defaultPrivacyLevel,n);r!==d.$m.HIDDEN&&r!==d.$m.IGNORE&&s.push({id:h(t.target),value:null!==(o=(0,d.rf)(t.target,!1,r))&&void 0!==o?o:null})}return s}(r.filter(t=>"characterData"===t.type&&!u(t.target)),n,s),p=function(t,e,n){const o=[],s=new Map,r=t.filter(t=>{const e=s.get(t.target);return!(e&&e.has(t.attributeName)||(e?e.add(t.attributeName):s.set(t.target,new Set([t.attributeName])),0))}),i=new Map;for(const t of r){if(t.target.getAttribute(t.attributeName)===t.oldValue)continue;const s=(0,d.PJ)(t.target,e.defaultPrivacyLevel,n),r=N(t.target,s,t.attributeName,e);let a;if("value"===t.attributeName){const e=m(t.target,s);if(void 0===e)continue;a=e}else a="string"==typeof r?r:null;let c=i.get(t.target);c||(c={id:h(t.target),attributes:{}},o.push(c),i.set(t.target,c)),c.attributes[t.attributeName]=a}return o}(r.filter(t=>"attributes"===t.type&&!u(t.target)),n,s);(l.length||p.length||c.length||a.length)&&e(A(0,{adds:a,removes:c,texts:l,attributes:p}),i)}(s.concat(i.takeRecords()),t,e,n),s=[]}const{throttled:a,cancel:u}=(0,c.n)(r,16,{leading:!1});return{addMutations(t){0===s.length&&(o=(0,tt.BB)(a,{timeout:100})),s.push(...t)},flush:r,stop(){o(),u()}}}(),i=new s((0,Q.dm)(r.addMutations));return i.observe(o,{attributeOldValue:!0,attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),{stop(){i.disconnect(),r.stop()},flush(){r.flush()}}}function nt(t,e){(0,d.XS)(t)&&e(t.shadowRoot),(0,d.wI)(t,t=>nt(t,e))}var ot=n(887),st=n(636);function rt({context:t,creationReason:e,encoder:n}){let o=0;const s=t.view.id,r={start:1/0,end:-1/0,creation_reason:e,records_count:0,has_full_snapshot:!1,index_in_view:a.K_(s),source:"browser",...t},i={cssText:{count:0,max:0,sum:0}};return a.H5(s),{addRecord(t,e,s){r.start=Math.min(r.start,t.timestamp),r.end=Math.max(r.end,t.timestamp),r.records_count+=1,r.has_full_snapshot||(r.has_full_snapshot=2===t.type),e&&function(t,e){t.cssText.count+=e.cssText.count,t.cssText.max=Math.max(t.cssText.max,e.cssText.max),t.cssText.sum+=e.cssText.sum}(i,e);const a=n.isEmpty?'{"records":[':",";n.write(a+JSON.stringify(t),t=>{o+=t,s(o)})},flush(t){if(n.isEmpty)throw Error("Empty segment flushed");n.write(`],${JSON.stringify(r).slice(1)}\n`),n.finish(e=>{a.L7(r.view.id,e.rawBytesCount),t(r,i,e)})}}}const it=5*k.OY;var at=n(713);function ct(t,e,n,u,l,p,f){const h=[],m=f||(0,s.sA)(e.sessionReplayEndpointBuilder,6e4,e=>{t.notify(14,{error:e}),(0,o.A2)("Error reported to customer",{"error.message":e.message})});let g;if((0,r.d0)())({addRecord:g}=function(t){const e=(0,r.Y9)();return{addRecord(n){const o=t.findView();e.send("record",n,o.id)}}}(u));else{const s=function(t,e,n,o,s,r){return function(t,s,r,i){let a={status:0,nextSegmentCreationReason:"init"};const{unsubscribe:c}=t.subscribe(2,()=>{l("view_change")}),{unsubscribe:u}=t.subscribe(11,t=>{l(t.reason)});function l(t){1===a.status&&(a.segment.flush((e,n,o)=>{const s=function(t,e,n,o){const s=new FormData;s.append("segment",new Blob([t],{type:"application/octet-stream"}),`${e.session.id}-${e.start}`);const r={raw_segment_size:o,compressed_segment_size:t.byteLength,...e},i=JSON.stringify(r);return s.append("event",new Blob([i],{type:"application/json"})),{data:s,bytesCount:t.byteLength,cssText:n.cssText,isFullSnapshot:0===e.index_in_view,rawSize:o,recordCount:e.records_count}}(o.output,e,n,o.rawBytesCount);(0,ot.Kp)(t)?r.sendOnExit(s):r.send(s)}),(0,st.DJ)(a.expirationTimeoutId)),a="stop"!==t?{status:0,nextSegmentCreationReason:t}:{status:2}}return{addRecord(t,s){if(2!==a.status){if(0===a.status){const t=function(t,e,n){const o=e.findTrackedSession(),s=n.findView();if(o&&s)return{application:{id:t},session:{id:o.id},view:{id:s.id}}}(e.applicationId,n,o);if(!t)return;a={status:1,segment:rt({encoder:i,context:t,creationReason:a.nextSegmentCreationReason}),expirationTimeoutId:(0,st.wg)(()=>{l("segment_duration_limit")},it)}}a.segment.addRecord(t,s,t=>{t>6e4&&l("segment_bytes_limit")})}},stop(){l("stop"),c(),u()}}}(t,0,s,r)}(t,e,n,u,m,l);g=s.addRecord,h.push(s.stop);const r=function(t,e,n){if(!e.enabled||!(0,at.ic)(t.segmentTelemetrySampleRate))return{stop:c.l};const{unsubscribe:s}=n.subscribe(t=>{if("failure"===t.type||"queue-full"===t.type||"success"===t.type&&t.payload.isFullSnapshot){const r=(e=t.type,n=t.bandwidth,{cssText:{count:(s=t.payload).cssText.count,max:s.cssText.max,sum:s.cssText.sum},isFullSnapshot:s.isFullSnapshot,ongoingRequests:{count:n.ongoingRequestCount,totalSize:n.ongoingByteCount},recordCount:s.recordCount,result:e,size:{compressed:s.bytesCount,raw:s.rawSize}});(0,o.Gk)("Segment network request metrics",{metrics:r})}var e,n,s});return{stop:s}}(e,p,m.observable);h.push(r.stop)}const{stop:y}=function(t){const{emit:e,configuration:n,lifeCycle:o}=t;if(!e)throw Error("emit function is required");const s=(n,o)=>{e(n,o),(0,i.b)("record",{record:n});const s=t.viewHistory.findView();a.$1(s.id)},r=function(){const t=new WeakMap;return{set(e,n){(e!==document||document.scrollingElement)&&t.set(e===document?document.scrollingElement:e,n)},get(e){return t.get(e)},has(e){return t.has(e)}}}(),c=((t,e,n)=>{const o=new Map,s={addShadowRoot(r){if(o.has(r))return;const i=et(e,t,s,r),a=Z(t,e,r),c=G(t,e,n,r);o.set(r,{flush:()=>i.flush(),stop(){i.stop(),a.stop(),c.stop()}})},removeShadowRoot(t){const e=o.get(t);e&&(e.stop(),o.delete(t))},stop(){o.forEach(({stop:t})=>t())},flush(){o.forEach(({flush:t})=>t())}};return s})(n,s,r),{stop:u}=function(t,e,n,o,s,r){const i=(n,s)=>{const{width:i,height:a}=(0,d.pB)();r({data:{height:a,href:window.location.href,width:i},type:4,timestamp:n}),r({data:{has_focus:document.hasFocus()},type:6,timestamp:n});const c={cssText:{count:0,max:0,sum:0}};r({data:{node:M(document,o,{status:s,elementsScrollPositions:t,serializationStats:c,shadowRootsController:e}),initialOffset:{left:(0,d.Gn)(),top:(0,d.zL)()}},type:2,timestamp:n},c),window.visualViewport&&r({data:$(window.visualViewport),type:8,timestamp:n})};i((0,k.nx)(),0);const{unsubscribe:a}=n.subscribe(2,t=>{s(),i(t.startClocks.timeStamp,1)});return{stop:a}}(r,c,o,n,l,s);function l(){c.flush(),f.flush()}const p=function(){const t=new WeakMap;let e=1;return{getIdForEvent(n){return t.has(n)||t.set(n,e++),t.get(n)}}}(),f=et(s,n,c,document),h=[f,z(n,s),F(n,s,p),G(n,s,r,document),W(n,s),Z(n,s),J(n,s),Y(s),q(n,s),B(n,s),j(o,s,p),K(o,t=>{l(),s(t)})];return{stop(){c.stop(),h.forEach(t=>t.stop()),u()},flushMutations:l,shadowRootsController:c}}({emit:g,configuration:e,lifeCycle:t,viewHistory:u});return h.push(y),{stop(){h.forEach(t=>t())}}}}}]);